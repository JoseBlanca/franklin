

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mapping &mdash; ngs_backbone v0.1 documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ngs_backbone v0.1 documentation" href="index.html" />
    <link rel="next" title="Annotation" href="annotation.html" />
    <link rel="prev" title="Mira assembly" href="assembly.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <h1><a href="index.html">ngs_backbone v0.1 documentation</a></h1>
        <div class="rel">
          <a href="assembly.html" title="Mira assembly"
             accesskey="P">previous</a> |
          <a href="annotation.html" title="Annotation"
             accesskey="N">next</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="mapping">
<h1>Mapping<a class="headerlink" href="#mapping" title="Permalink to this headline">¶</a></h1>
<p>A set of read files can be mapped against a reference genome. For the mapping ngs_backbone uses bwa with two algorithms, one for the long reads (sanger and 454) and other for the short reads (illumina). The result is a set of bam files one for each input read file or a merged bam file with all reads in it.</p>
<div class="section" id="input-and-output-files">
<h2>Input and output files<a class="headerlink" href="#input-and-output-files" title="Permalink to this headline">¶</a></h2>
<p>The read files should be located in reads/cleaned/ and should follow the <a class="reference internal" href="introduction.html"><em>naming conventions</em></a>. It is very important to set in the read file names the library, sample and platforms, otherwise the realignment and the SNP calling will fail. The reference genome should be located in mapping/reference as a fasta file.</p>
<p>Once bwa is finished a timestamped mapping directory will contain a bams/by_readgroup subdirectory with one bam file for each input read file. Every one of such bam files is considered to be a read group. After the mapping is finished a merge_bam analysis can be done. That analysis will merged all bam files located in bams/by_reagroup and will create an unique bam file in bams/merged.bam. This bam file will contain as many read groups as bam files are merged. Every read group will retain the information about the library, sample and platform.</p>
</div>
<div class="section" id="running-the-analysis">
<h2>Running the analysis<a class="headerlink" href="#running-the-analysis" title="Permalink to this headline">¶</a></h2>
<p>The analysis is run in divided in two ngs_backbone analysis:</p>
<dl class="docutils">
<dt>mapping</dt>
<dd>It maps the reads with bwa creating one bam for every input file</dd>
<dt>merge_bam</dt>
<dd>It merges all bam files located in mapping/bams/by_readgroup into mapping/bams/merged.bam. The obtained bam will comply not only with the samtools standard but also with the picard and GATK requirements.</dd>
</dl>
</div>
</div>
<div class="section" id="bam-realignment">
<span id="id1"></span><h1>Bam realignment<a class="headerlink" href="#bam-realignment" title="Permalink to this headline">¶</a></h1>
<p>This analysis does a GATK <a class="reference external" href="http://www.broadinstitute.org/gsa/wiki/index.php/Local_realignment_around_indels">realignment</a>. The mappings are usually done aligning each read with the reference genome at a time. These methodology can cause artifacts in the multiple sequence alignment obtained. GATK is capable of solving these artifacts. Their algorithm is described in its own site.</p>
<div class="section" id="id2">
<h2>Input and output files<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>The only one input file should be mapping/bams/merged.bam. This bam file contains all the reads mapped to the reference genome. The output file will be also mapping/bams/merged.bam (a versioned copy).</p>
</div>
<div class="section" id="id3">
<h2>Running the analysis<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>The corresponding ngs_backbone is realign_bam.</p>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#third-party-software">Third party software</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#naming-conventions">Naming conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#available-analyses">Available analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#parallel-operation">Parallel operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cleaning.html">Cleaning sequence reads</a></li>
<li class="toctree-l1"><a class="reference internal" href="assembly.html">Mira assembly</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Mapping</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input-and-output-files">Input and output files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-analysis">Running the analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#bam-realignment">Bam realignment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">Input and output files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">Running the analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="annotation.html">Annotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="snv_filters.html">Snv filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="seqio.html">seq_io</a></li>
<li class="toctree-l1"><a class="reference internal" href="seqio.html#seqio-supported-formats">Seqio supported formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="download.html">Download</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="search.html" method="get">
            <input type="text" name="q" size="18" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="assembly.html" title="Mira assembly"
             >previous</a> |
          <a href="annotation.html" title="Annotation"
             >next</a> |
          <a href="genindex.html" title="General Index"
             >index</a>
            <br/>
            <a href="_sources/mapping.txt"
               rel="nofollow">Show Source</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2010, Jose Blanca.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>