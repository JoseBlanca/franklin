

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Annotation &mdash; ngs_backbone v0.1 documentation</title>
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ngs_backbone v0.1 documentation" href="index.html" />
    <link rel="next" title="Snv filters" href="snv_filters.html" />
    <link rel="prev" title="Mapping" href="mapping.html" /> 
  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <h1><a href="index.html">ngs_backbone v0.1 documentation</a></h1>
        <div class="rel">
          <a href="mapping.html" title="Mapping"
             accesskey="P">previous</a> |
          <a href="snv_filters.html" title="Snv filters"
             accesskey="N">next</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="annotation">
<h1>Annotation<a class="headerlink" href="#annotation" title="Permalink to this headline">¶</a></h1>
<p>There are different annotation analyses for the sequences, but they all operate in a similar way, so it is worth to explain the general annotation process. The sequences to annotate should be placed in one or several files at annotations/input/. When an annotation is done the results are stored in a kind of database at annotations/db/. There is a versioned file in annotations/db/ for each original file set to annotate. The annotations are cumulative, so if we annotate the ORF and after that the SSRs both will be stored at annotations/db/. At every time after an annotation the real output files can be generated running the write_annotation analysis. The output files will be found at annotations/features/. The output files are:</p>
<ul class="simple">
<li><a class="reference external" href="http://1000genomes.org/wiki/doku.php?id=1000_genomes:analysis:vcf4.0">VCF</a> file. It stores the SNP and indel information.</li>
<li>DNA and pep ORF fasta files. The DNA to translate and the translation.</li>
<li>a csv file for the SSR (microsatellite) information.</li>
<li><a class="reference external" href="http://www.sequenceontology.org/resources/gff3.html">GFF</a> file. It stores all found sequence features.</li>
<li>annot and dat files for Blast2Go.</li>
<li>a text file with the orthologs.</li>
</ul>
<div class="section" id="snp-calling">
<span id="id1"></span><h2>SNP calling<a class="headerlink" href="#snp-calling" title="Permalink to this headline">¶</a></h2>
<p>SNP calling is a form of sequence annotation. To annotate some sequences you need the input sequences to annotate, a bam file in mapping/bams/merged.bam and a reference genome in mapping/reference/reference.fasta. SNP calling is based on the samtools pileup with some filters on top. The ngs_backbone analysis is: annotate_snv.</p>
<div class="section" id="configuration-parameters">
<h3>Configuration parameters<a class="headerlink" href="#configuration-parameters" title="Permalink to this headline">¶</a></h3>
<p>In the section Snvs:</p>
<dl class="docutils">
<dt>min_quality</dt>
<dd>Minimum allele quality. The alleles with a lower quality will not be consider. It is a phred quality.</dd>
<dt>min_mapq</dt>
<dd>Reads mapped with a lower quality will not be considered. This is the phred quality found on the bam file.</dd>
<dt>min_num_alleles</dt>
<dd>Usually it will be 1 or 2. If 1 the positions with only one allele different from the reference will be considered if 2 only the positions with at least 2 alleles will be considered.</dd>
<dt>default_bam_platform</dt>
<dd>Default is None. Backbone takes platform information from the bam file. If your bam doesn&#8217;t have readgroup information. You can provide the platform information using this option. Backbone needs platform information to perform the snv calling.</dd>
</dl>
<p>Also a subsection edge_removal inside Snvs could be defined. The parameters in this section are used to when we want to ignore the nucleotides close to the edged of the reads. This parameters are dependent on the platform and are: 454_left, 454_right, sanger_left, sanger_right, illumina_left and illumina_right.</p>
</div>
</div>
<div class="section" id="snv-filtering">
<span id="snv-filter"></span><h2>SNV filtering<a class="headerlink" href="#snv-filtering" title="Permalink to this headline">¶</a></h2>
<p>Once you have the snv annotated, you may not want all of them. Only some of then may be of your interest. ngs_backbone provide an analysis to filter snvs.</p>
<p>Yo can find more information on how to use this analysis <a class="reference internal" href="snv_filters.html"><em>here</em></a>.</p>
</div>
<div class="section" id="blast-databases">
<span id="id2"></span><h2>Blast databases<a class="headerlink" href="#blast-databases" title="Permalink to this headline">¶</a></h2>
<p>Several annotations make use of blast. ngs_backbone requires some data about the blast databases to be able to run. This information should be set up in the ngs_backbone.conf file on the blast section. In this section for each blast database a subsection for every database should be prepared. An example for the nr would be:</p>
<div class="highlight-python"><pre>[blast]
[[nr]]
path = /absolute/path/to/blast/database
species = 'all'  #this database is not species specific
kind = 'prot'    #or nucl for nucleotide databases</pre>
</div>
</div>
<div class="section" id="description-annotation">
<span id="id3"></span><h2>Description annotation<a class="headerlink" href="#description-annotation" title="Permalink to this headline">¶</a></h2>
<p>A description for the sequences can be created blasting some databases. Several blast databases can be used in a sequential way. Once a sequence has a blast hit in one of the databases, the description will be build from the description of that hit. For instance let&#8217;s imagine that we have to annotate 10 sequences with the databases swissprot and tair. Both blasts would be carried out. If we find significant hits for 5 sequences in swissprot those sequence would be already annotated and a description for the 5  remaining sequences will be look for at the second database (tair in this case). The corresponding ngs_backbone analysis is annotate_description.</p>
<div class="section" id="id4">
<h3>Configuration parameters<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>In the ngs_backbone.conf section Annotation, subsection description_annotation the parameter description_databases should have a list of at least one blast database. The blast databases used should be defined in the corresponding section, see ::<cite>blast-databases</cite>.</p>
</div>
</div>
<div class="section" id="go-annotation">
<span id="id5"></span><h2>GO annotation<a class="headerlink" href="#go-annotation" title="Permalink to this headline">¶</a></h2>
<p>ngs_backbone annotates the <a class="reference external" href="http://www.sequenceontology.org/resources/gff3.html">Gene Ontology</a> ontology terms by using <a class="reference external" href="http://www.blast2go.org/">blast2go</a>. Blast2GO uses the results of a blast nr search to infer the relevant GO terms for every sequence. The corresponding blast analysis is annotate_go.</p>
<div class="section" id="output-files">
<h3>Output files<a class="headerlink" href="#output-files" title="Permalink to this headline">¶</a></h3>
<p>The Blast2GO executable creates two files that can be loaded by the graphical Blast2GO interface, the annot and the dat file. Both will be present at the directory annotations/features. Be aware that generating the dat file will require quite memory.</p>
</div>
<div class="section" id="id6">
<h3>Configuration parameters<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>In the ngs_backbone.conf annotation section a go_annotation subsection should be present. The parameters are:</p>
<dl class="docutils">
<dt>create_dat_file</dt>
<dd>It can be set to True or False</dd>
<dt>java_memory</dt>
<dd>This optional parameter is especially important if the creation of the dat file is required.</dd>
<dt>b2g_properties_file</dt>
<dd>Optionaly you can configure blast2go&#8217;s properties tunning this file.</dd>
</dl>
</div>
</div>
<div class="section" id="orf-annotation">
<span id="id7"></span><h2>ORF annotation<a class="headerlink" href="#orf-annotation" title="Permalink to this headline">¶</a></h2>
<p>To annotate the ORFs found in your sequences just run the ngs_backbone analysis annotate_orf. ESTScan will be used to look for the ORFs. The output will be (after running write_annotation) a couple of files for each input file, one for the DNA and another for the proteins.</p>
<div class="section" id="id8">
<h3>Configuration parameters<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>In order to run this analysis in the section orf_annotation at the ngs_backbone.conf file the estscan_matrix matrix file should be defined. This is a valid specific matrix file for ESTScan</p>
</div>
</div>
<div class="section" id="microsatellite-annotation">
<span id="ssr-annotation"></span><h2>Microsatellite annotation<a class="headerlink" href="#microsatellite-annotation" title="Permalink to this headline">¶</a></h2>
<p>The SSRs can be annotated just by running the ngs_backbone analysis annotate_microsatellite. The result of this analysis will be shown in the gff file and in a csv microsatellite file.</p>
</div>
<div class="section" id="ortholog-annotation">
<span id="id9"></span><h2>Ortholog annotation<a class="headerlink" href="#ortholog-annotation" title="Permalink to this headline">¶</a></h2>
<p>ngs_backbone can annotate the orthologs doing a reciprocal blast search. It can be done on one or several blast databases. The ngs_backbone analysis is called ortholog_annotation. The list of orthologs will be found in annotations/features/</p>
<div class="section" id="id10">
<h3>Configuration parameters<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>In the ngs_backbone.conf section Annotation, subsection ortholog_annotation the parameter ortholog_databases should have a list of at least one blast database. The blast databases used should be defined in the corresponding section, see ::<cite>blast-databases</cite>.</p>
</div>
</div>
<div class="section" id="cdna-intron-annotation">
<span id="intron-annotation"></span><h2>cDNA intron annotation<a class="headerlink" href="#cdna-intron-annotation" title="Permalink to this headline">¶</a></h2>
<p>When the sequences to annotate are cDNA ngs_backbone can guess where the introns were by using the analysis annotate_introns. To do it it aligns the cDNA with a genomic sequence using the emboss program est2genome. As a shortcut ngs_backbone before running est2genome with the whole genomic sequence it does a blast search to look for the relevant genome region and only after that the est2genome alignment is done.</p>
<div class="section" id="id11">
<h3>Configuration parameters<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>In the ngs_backbone.conf section Annotation, subsection Cdna_intron_annotation the parameter genomic_db should have one blast database. The blast database used should be defined in the corresponding section, see ::<cite>blast-databases</cite>. Also in the same section the parameter genomic_seqs should have the absolute path to the fasta file with the genomic sequences that make up the employed database.</p>
</div>
</div>
<div class="section" id="annotation-statistics">
<h2>Annotation statistics<a class="headerlink" href="#annotation-statistics" title="Permalink to this headline">¶</a></h2>
<p>Once we have annotated some sequences we can get a summary of the process by running the annotation_stats analysis. It will create one text file for each input annotation file with statistics about: description, microsatellites, SNVs, ORF, GO terms and orhologs.</p>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#third-party-software">Third party software</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#usage">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#naming-conventions">Naming conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#available-analyses">Available analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#parallel-operation">Parallel operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cleaning.html">Cleaning sequence reads</a></li>
<li class="toctree-l1"><a class="reference internal" href="assembly.html">Mira assembly</a></li>
<li class="toctree-l1"><a class="reference internal" href="mapping.html">Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="mapping.html#bam-realignment">Bam realignment</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Annotation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#snp-calling">SNP calling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#snv-filtering">SNV filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="#blast-databases">Blast databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#description-annotation">Description annotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#go-annotation">GO annotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#orf-annotation">ORF annotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#microsatellite-annotation">Microsatellite annotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ortholog-annotation">Ortholog annotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cdna-intron-annotation">cDNA intron annotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#annotation-statistics">Annotation statistics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="snv_filters.html">Snv filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="seqio.html">seq_io</a></li>
<li class="toctree-l1"><a class="reference internal" href="seqio.html#seqio-supported-formats">Seqio supported formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="download.html">Download</a></li>
</ul>

          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="search.html" method="get">
            <input type="text" name="q" size="18" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="mapping.html" title="Mapping"
             >previous</a> |
          <a href="snv_filters.html" title="Snv filters"
             >next</a> |
          <a href="genindex.html" title="General Index"
             >index</a>
            <br/>
            <a href="_sources/annotation.txt"
               rel="nofollow">Show Source</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2010, Jose Blanca.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.7.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>